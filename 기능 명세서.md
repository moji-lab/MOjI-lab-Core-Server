# Project-MOjI 기능 명세서

## 0. 용어 정리

* 기록하기 : 코스들의 집합, 코스들이 모여서 기록하기가 됨, 기록하기를 먼저 진행하고 여기에 각 코스를 추가
  * 나의 제주도 여행기
  * 잠실역 놀러가기
  * 전국일주 - 기록 하기 할 때 장소에 전국 
* 코스 : 기록하기의 한 단위, 코스들이 모여서 기록하기가 됨
  * 성산일출봉
  * 협재 해수욕장
  * 롯데타워 전망대
  * 석촌호수
  * 송리단길
  * 속초 해수욕장
  * 목포 수산시장
  * 전주 한옥마을
  * 대전 엑스포
* 기록하기와 코스에 장소, 주소 개념 오류는 무시
  * 우리는 무조건 한 지역에 방문해서 해당 지역의 장소만 방문한다고 가정하고 이에 맞춤
  * 기록하기 장소가 서울이면
    * 코스들은 오직 서울 안의 주소들만 가진다.
  * 아침에 서울찍고 낮에 춘천찍고 밤에 속초 찍어서 한 기록하기 안에 세가지 주소를 가진 코스가 존재하는 경우는 고려하지 않는다.
* 장소 : 경복궁, 서울시청, 롯데타워 = 키워드
* 주소 : 서울시 관악구 남부순환로 241, 서울시 종로구 사직로 161
* 해시태크 : #궁 #고궁 #누리네집
  * 띄어쓰기 안됨
* 게시글 공유 == 친구 태그

## 1. 로그인, 회원가입

* 이메일, 비밀번호 로 로그인
* 최초 로그인 후 이후 자동 로그인
  * 프론트 엔드에서 토큰 저장 필요
  * 토큰이 저장되어 있지 않다면 로그인 페이지, 저장되어 있다면 토큰 검증 API후 메인 페이지 이동
* 회원가입
  * 이메일
  * 비밀번호, 비밀번호 재입력
  * 닉네임
  * 회원 가입 버튼 누른 후 이메일 중복, 닉네임 중복 확인
    * 중복 일 경우 해당 메시지 반환
      * 중복된 이메일입니다.(상태코드 400)
      * 중복된 닉네임입니다.(상태코드 400)

## 2. 홈(1번 탭)

* 현재는 주제 고정
* 현재장소 현재날씨 표시 안함
* 가을 기준
  * 단풍 놀이, 불꽃 축제, 가을 축제
  * 갈대, 억새, 코스모스
  * 전어, 음식, 맛집
  * 데이트 코스, 힐링 코스
  * 바다, 서울 근교
  * 당일치기, 1박2일, 엠티, 커플여행, 가족여행, 우정여행, 혼자여행
* 중 5개 기록하기 리스트 표시 - 많으면 3개
  * 1번 주제 기록하기 리스트 - 가로 스크롤
  * 2번 주제 기록하기 리스트 - 가로 스크롤
  * 3번 주제 기록하기 리스트 - 가로 스크롤
  * 4번 주제 기록하기 리스트 - 가로 스크롤
  * 5번 주제 기록하기 리스트 - 가로 스크롤

## 3. 지도(2번 탭)

* 장소, 주소, 해시태그로 검색 가능
* 검색 3가지 경우의 수
  - 장소 검색 - 경복궁
  - 주소 검색 - 서울 종로구 사직로161(세종로)
  - 해시태그 검색 - #궁 #고궁..
* **검색 알고리즘**
  * 클라는 세개 구분 없이 동일하게 검색
  * 서버에서는 3가지 경우의 수
    - 검색어에 #이 있을경우 해시 태그 테이블 조회
    - 없을 경우 장소, 주소 검색
    - 장소 - ADDRESS 테이블 조회
    - 주소 - 관광 API 사용
* **검색 결과 데이터 구성**
  * 검색했을 때 나오는 키워드의 총 개수를 더한 값이 5보다 클 경우만 검색 결과 데이터 구성
  * 해시 태그 검색일 경우 해당 해시 태그가 사용된 **코스** 리스트 반환
  * 장소 & 주소 검색일 경우
    * 기록하기, 코스 상관 없이 좋아요 개수가 높은 것 순으로 정렬
    * 입력 받은 키워드로 장소도 조회하고, 주소도 조회
    * 프론트엔드에서는 결과 리스트가 기록하기인지 코스인지 판단해서 맞게 뷰를 표시
      * 판단 인덱스 검색 결과 반환값에 포함
        * type : 0/1
          * 0 : board
          * 1 : course
    * 기록하기 결과물
      * 닉네임
      * 프로필사진
      * 장소
      * 날짜
      * 대표 사진
      * 좋아요 수
      * 댓글 수
    * 코스 결과물
      * 닉네임
      * 프로필사진
      * 장소
      * 주소
      * 날짜
      * 내용
      * 좋아요 수
      * 댓글 수
* 검색 시 실시간 검색
  - 프론트 엔드에서 키보드 입력 끝날 때 마다 서버랑 통신
* 최근 검색 내역 안함
* 기간 설정 - 년/월/일 - 시작과 종료 선택 가능
* 서버에선 기간 설정 안할 경우 전체 기간으로 검색
* GPS가 켜져 있다면 현재 장소 주변 검색
* 꺼져 있다면 서울(광화문)을 중심으로 검색
* 검색 결과
  * 뷰 절반은 지도에 **핀**이 찍힘
  * 뷰 절반은 **기록하기 & 코스** 리스트
  * 게시물 개수에 따라 색깔로 표시
    * 10?개 - ?색
    * 50?개 - ?색
    * 100?개 - ?색
    * 100?개 이상 - ?색

## 4. 기록 하기(3번 탭)

### 4-1. 기록하기

* 게시글을 공개, 비공개 설정
* 장소 작성 (서울, 잠실, 종로, 광화문, 경복궁, 롯데타워)
  * 장소 검색 - 관광 API 사용
  * 장소추가 없음
* 코스 추가
* 방문 날짜 선택
* 순서 변경 - 서버에 보내줄 때 객체에 별도 인덱스를 만들고 여기에 순서를 부여해줘서 보내야 함
  * 그냥 보내면 순서대로 들어올지 안들어올지 모르겠음(노드는 안들어옴)
* 친구 태그(공유)

### 4-2. 코스 추가

* 해당 코스의 장소 입력
  * 장소 검색 - 관광 API 사용
  * 장소추가 없음
* 해당 코스의 실제 주소 입력(서울시 관악구 남부순환로...)
  * 코스 검색 - 관광 API 사용
* 사진 업로드(최대 30개)
  * 사진은 모두 기본값으로 공개
  * 첫번째 사진은 무조건 대표 사진
  * 각 코스당 공개 사진은 무조건 1장 이상
  * 자물쇠 아이콘 누르면 비공개
* 방문 날짜 선택
* 내용 입력
* 해시 태그 입력
  * 해시 태그를 검색하고 있으면 해당 해시태그 적용
  * 없으면 새로 추가

### 4-3. 권한 공유(친구 태그)

* 이메일, 닉네임으로 검색
* 서버에서는 둘 다 조회
* 최종적으로 클라이언트에서 배열로 서버에 전송
* 권한 공유가 되면 해당 친구에게 알람 메시지 전송(생성)
* 권한 공유 받은 사람의 초기 공개 여부는 비공개
  * 이후 공개 여부는 각자 제어
  * 하나의 글을 공유 하는 것이 아니고 각자에게 작성됨

## 5. 랜덤 기록하기 목록 조회 (4번탭)

* 검색 창 상단 존재
* 기록하기 랜덤으로 조회해서 반환
* 지도는 보여주지 않음
* 표시되는 데이터
  * 닉네임
  * 작성자 프로필 사진
  * 날짜
  * 대표사진들
  * 장소(경복궁, 잠실 롯데 타워)
  * 기록하기 좋아요 수, 기록하기 댓글 갯수
  * 스크랩 당한 횟수 표시 X

## 6. 기록하기, 코스 조회

* 기록 하기 댓글 존재
  * 대댓글 X
  * 댓글 좋아요 X
  * 사람 태그 안됨
* 코스 댓글 존재
  * 대댓글 X
  * 댓글 좋아요 X
  * 사람 태그 안됨
* 기록하기 좋아요
* 코스 좋아요
* 좋아요 갯수만 표시, 누가 했는지는 모름
  * 서버에서는 누가 어떤 기록하기, 코스에 좋아요 했는지 기록
* 사진은 공개된 사진만 표시
  * 작성자이거나, 공유된 사람들은 모든 사진 표시
* 사진 다운로드 가능
  * 작성자이거나, 공유된 사람들은 모든 사진 다운로드 가능
* 사진 다운로드 시 선택 선택 선택 해서 한번에 다운로드
  * 클라이언트가 힘들어 보여서 후순위

## 7. 마이 페이지(5번 탭)

* 백 그라운드 사진 없음
* 내 프로필 사진 변경 가능
* 내 닉네임 표시 - 닉네임 변경 가능
* 내가 작성한 기록하기 갯수, 내가 공유 된 글 갯수, 내가 스크랩 한 글 갯수 표시
* 스크랩 갯수 누르면 스크랩 한 피드 목록으로 이동
  * 스크랩 한 피드 조회 삭제 가능
  * 기록하기 조회 시 스크랩 버튼 필요
* 공유 갯수 누르면 내가 공유 된 글만 조회
  * 삭제
  * 공개, 비공개 - 토글
  * 피드 사진 다운로드 가능
* 내 기록하기 조회
  * 삭제
  * 공개, 비공개 - 토글
  * 피드 사진 다운로드 가능
* 알람 아이콘 (어딘가에..)
  * 알람이 표시되는 경우 : 내가 태그 된 경우 표시
  * 알람 삭제 안됨
  * 날짜 내림차순

## 8. DB

1. 기록하기 - MongoDB
   1. 기록하기 안에 댓글들을 저장
   2. 좋아요 갯수 저장
   3. 공유 
2. 코스 - MongoDB
   1. 코스 안에 사진들을 저장
   2. 코스 안에 댓글들을 저장
   3. 좋아요 갯수 저장
   4. 좋아요 내역?